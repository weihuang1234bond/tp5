<!DOCTYPE html>
<html class="theme theme-white">
<head>
<meta charset="utf-8">
<title>Git</title>
<link href="https://www.zybuluo.com/static/assets/template-theme-white.css" rel="stylesheet" media="screen">
<style type="text/css">

#wmd-preview h1  {
    color: #0077bb; /* 将标题改为蓝色 */
}</style>
</head>
<body class="theme theme-white">
<div id="wmd-preview" class="wmd-preview wmd-preview-full-reader"><div class="md-section-divider"></div><div class="md-section-divider"></div><h1 data-anchor-id="jbs4" id="git">Git</h1><p data-anchor-id="8zfk"><code>服务器</code></p><hr><blockquote data-anchor-id="alev" class="white-blockquote">
  <p>一 Git简介 <br>
  二 安装Git <br>
  三 自报家门 <br>
  四 客户端代码管理  <br>
  五 服务器端代码管理 <br>
  六 本地仓库代码推送到远程仓库 <br>
  七 团队协作 <br>
  八 版本回退 <br>
  九 分支管理</p>
</blockquote><div class="md-section-divider"></div><h2 data-anchor-id="qpxl" id="一-git简介">一 Git简介</h2><p data-anchor-id="ko04">Git是目前世界上最先进的分布式版本控制系统（没有之一）</p><div class="md-section-divider"></div><h3 data-anchor-id="otj2" id="11-何为分布式与集中式相比有何特点">1.1 何为分布式？与集中式相比有何特点？</h3><p data-anchor-id="bnjx">以svn为例 <br>
<img src="http://on64ewxzt.bkt.clouddn.com/blog/20180328/085121597.png" alt="mark" title=""> <br>
而git是这样的 <br>
<img src="http://on64ewxzt.bkt.clouddn.com/blog/20180328/085138094.png" alt="mark" title=""> <br>
每个开发者的电脑上,都有完整的版本,日志,及分支信息. <br>
但开发者不依赖于服务器,可以查看日志,回退版本,创建分支. <br>
当然,世界各地的开发需要交换最新的版本信息,因此,git 往往也需要服务器.</p><p data-anchor-id="mt74">但是,本质的区别在于: <br>
git 服务器是供开发者"交换"代码,服务器数据丢了没关系,分分钟再建一台. svn的服务器,不仅交换代码,还控制着日志,版本,分支.服务器数据丢了就完了.</p><div class="md-section-divider"></div><h3 data-anchor-id="le5v" id="12-发展历史">1.2  发展历史</h3><p data-anchor-id="94h7">Linux 之父 Linus Torvalds 在 1991 年创建了 linux 开源项目,并把项目放在互联网上,引来世界大量的黑客,大神为项目贡献代码.</p><p data-anchor-id="zjwt">问题是,这么多的人同时贡献代码,如何管理代码成了一件头疼的事.</p><p data-anchor-id="ou85">随着 linux 内核的管理工作越来越吃力,linus 选择了一款商业版本控制器-BitKeeper.</p><p data-anchor-id="4kkb">BitKeeper 是 BitMover 公司旗下的产品.</p><p data-anchor-id="jssz">公司的老大 Larry 也希望借机扩大产品的影响力,因此授权 Linux 社区免费使用 BitKeeper.</p><p data-anchor-id="z5rw">这件事,在开源圈引起了不小的骚动.</p><p data-anchor-id="i3q3">因为,BitKeeper 只是 free(免费),而非 free(自由).</p><p data-anchor-id="ealr">开源教主 RMS 为这事儿还说过 linus.</p><p data-anchor-id="pska">2002 年 2 月,Linus 开始用它来管理 Linux 内核代码主线,Linus 对 BitKeeper 的评价是 the best tool for the job. 确实,自从 Linus 使用 BitKeeper 之后,Linux 的开发步伐加快了两倍.</p><p data-anchor-id="kz5z">可惜的是,就像黑帮电影中,老大蒸蒸日上的事业,往往坏在一个不懂事的小弟手中.</p><p data-anchor-id="j0lf">这帮视 free(自由)如信仰的牛人中,一个叫 Andrew 的,试图破解 BitKeeper 的协议,且被 BitMover 公司警告几次后仍不停手.</p><p data-anchor-id="8ltc">最终,出事了!</p><p data-anchor-id="pcy9">Linus 在 Andrew 和 Larry 两人间费力调停,但没有成功.</p><p data-anchor-id="n3os">既如此,Linus 说:"我的兄弟只是做错事不是做坏事. 我扛!"</p><p data-anchor-id="lk1h">于是,10 天后,git 诞生了!</p><div class="md-section-divider"></div><h2 data-anchor-id="cfij" id="二-安装git">二 安装Git</h2><p data-anchor-id="t8xi">git 在 Linux,Mac,Win 下都可以安装.</p><p data-anchor-id="unbb">本文是以 Win7 系统为环境编写的.</p><p data-anchor-id="azcw"><strong>Window 环境:</strong></p><p data-anchor-id="p9fs">到 <a href="https://git-for-windows.github.io/" target="_blank">https://git-for-windows.github.io/</a> 下载软件, 双击,一路"Next",安</p><p data-anchor-id="tdho">装完毕.到开始菜单找"git bash",如下图 <br>
<img src="http://on64ewxzt.bkt.clouddn.com/blog/20180328/085648519.png" alt="mark" title=""></p><p data-anchor-id="4lzt"><strong>Linux 环境安装 git:</strong></p><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="sp0c"><ol class="linenums"><li class="L0"><code><span class="com"># ubuntu,debian#</span></code></li><li class="L1"><code><span class="pln">$ sudo apt</span><span class="pun">-</span><span class="kwd">get</span><span class="pln"> install git</span></code></li></ol></pre><p data-anchor-id="tp6n"><strong>centos,redhat 系统</strong></p><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="4vgu"><ol class="linenums"><li class="L0"><code><span class="com"># yum install git</span></code></li></ol></pre><div class="md-section-divider"></div><h2 data-anchor-id="po41" id="三-自报家门">三 自报家门</h2><p data-anchor-id="xyy8">人在江湖,岂能没有名号.</p><p data-anchor-id="b2mu">开源教主 Richard Matthew Stallman 的江湖名号 RMS.</p><p data-anchor-id="chdu">在你用 git 之前,要先报家门,否则代码不能提交.</p><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="a9vw"><ol class="linenums"><li class="L0"><code><span class="pln">$ git config </span><span class="pun">--</span><span class="kwd">global</span><span class="pln"> user</span><span class="pun">.</span><span class="pln">name </span><span class="com">#你是谁</span></code></li><li class="L1"><code><span class="pln">$ git config </span><span class="pun">--</span><span class="kwd">global</span><span class="pln"> user</span><span class="pun">.</span><span class="pln">email </span><span class="com">#怎么联系你</span></code></li></ol></pre><p data-anchor-id="w2y1"><img src="http://on64ewxzt.bkt.clouddn.com/blog/20180328/090053451.png" alt="mark" title=""></p><div class="md-section-divider"></div><h2 data-anchor-id="u82b" id="四-客户端代码管理">四 客户端代码管理</h2><div class="md-section-divider"></div><h3 data-anchor-id="w18c" id="41-工作区和版本库">4.1 工作区和版本库</h3><p data-anchor-id="co29">Git和其他版本控制系统如SVN的一个不同之处就是有暂存区的概念。</p><p data-anchor-id="csjq">先来看名词解释。</p><p data-anchor-id="lm9b"><strong>工作区（Working Directory）</strong></p><p data-anchor-id="8vke">就是你在电脑里能看到的目录，比如我的learngit文件夹就是一个工作区： <br>
<img src="http://on64ewxzt.bkt.clouddn.com/blog/20180328/090525153.png" alt="mark" title=""></p><p data-anchor-id="p71d"><strong>版本库（Repository）</strong></p><p data-anchor-id="omcf">工作区有一个隐藏目录.git，这个不算工作区，而是Git的版本库。</p><p data-anchor-id="8p7v">Git的版本库里存了很多东西，其中最重要的就是称为stage（或者叫index）的暂存区，还有Git为我们自动创建的第一个分支master，以及指向master的一个指针叫HEAD。 <br>
<img src="http://on64ewxzt.bkt.clouddn.com/blog/20180328/090711378.png" alt="mark" title=""></p><p data-anchor-id="3b0u">分支和HEAD的概念我们一会再讲。</p><p data-anchor-id="ppqo">前面讲了我们把文件往Git版本库里添加的时候，是分两步执行的：</p><p data-anchor-id="jylp">第一步是用git add把文件添加进去，实际上就是把文件修改添加到暂存区； <br>
<img src="http://on64ewxzt.bkt.clouddn.com/blog/20180328/090930295.png" alt="mark" title=""> <br>
第二步是用git commit提交更改，实际上就是把暂存区的所有内容提交到当前分支。 <br>
<img src="http://on64ewxzt.bkt.clouddn.com/blog/20180328/090950750.png" alt="mark" title=""> <br>
因为我们创建Git版本库时，Git自动为我们创建了唯一一个master分支，所以，现在，git commit就是往master分支上提交更改。</p><p data-anchor-id="6aot">你可以简单理解为，需要提交的文件修改通通放到暂存区，然后，一次性提交暂存区的所有修改。</p><div class="md-section-divider"></div><h2 data-anchor-id="rhdv" id="五-服务器端代码管理">五 服务器端代码管理</h2><div class="md-section-divider"></div><h3 data-anchor-id="q8j6" id="51-github">5.1 GitHub</h3><p data-anchor-id="r2sr">我们一直用GitHub作为免费的远程仓库，如果是个人的开源项目，放到GitHub上是完全没有问题的。其实GitHub还是一个开源协作社区，通过GitHub，既可以让别人参与你的开源项目，也可以参与别人的开源项目。</p><div class="md-section-divider"></div><h3 data-anchor-id="svsq" id="52-github创建远程仓库">5.2 GitHub创建远程仓库</h3><div class="md-section-divider"></div><h4 data-anchor-id="77cd" id="521-注册并登录github官网">5.2.1 注册并登录GitHub官网</h4><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="2qff"><ol class="linenums"><li class="L0"><code><span class="pln">https</span><span class="pun">:</span><span class="com">//github.com/</span></code></li></ol></pre><div class="md-section-divider"></div><h4 data-anchor-id="8bpr" id="522-创建远程仓库">5.2.2 创建远程仓库</h4><p data-anchor-id="ava1">点击new repository按钮创建仓库 <br>
<img src="http://on64ewxzt.bkt.clouddn.com/blog/20180328/091536561.png" alt="mark" title=""> <br>
填写仓库名称、项目描述、是否公开仓库、是否用readme文件初始化仓库 <br>
<img src="http://on64ewxzt.bkt.clouddn.com/blog/20180328/091813943.png" alt="mark" title=""></p><p data-anchor-id="hmnu">返回如下界面表示仓库创建成功 <br>
<img src="http://on64ewxzt.bkt.clouddn.com/blog/20180328/091958900.png" alt="mark" title=""></p><div class="md-section-divider"></div><h4 data-anchor-id="crex" id="523-查看远程仓库">5.2.3 查看远程仓库</h4><p data-anchor-id="g52x">查看远程仓库:git remote</p><p data-anchor-id="w4ug">查看仓库地址:git remote -v</p><p data-anchor-id="hlt9">例:</p><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="ycrz"><ol class="linenums"><li class="L0"><code><span class="pln">git remote </span><span class="pun">-</span><span class="pln">v</span></code></li><li class="L1"><code></code></li><li class="L2"><code><span class="pln">origin https</span><span class="pun">:</span><span class="com">//git.oschina.net/lianshou/test.git (fetch) origin https://git.oschina.net/lianshou/test.git (push)</span></code></li></ol></pre><div class="md-section-divider"></div><h3 data-anchor-id="0k50" id="524-删除远程库">5.2.4 删除远程库</h3><p data-anchor-id="zvxr">命令:git remote remove &lt;远程库名&gt;</p><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="r4rp"><ol class="linenums"><li class="L0"><code><span class="pun">示例:</span><span class="pln">git remote remove origin</span></code></li></ol></pre><div class="md-section-divider"></div><h3 data-anchor-id="o5ek" id="525-修改远程库名称">5.2.5 修改远程库名称</h3><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="qgp5"><ol class="linenums"><li class="L0"><code><span class="pln">git remote rename </span><span class="pun">&lt;旧名称&gt;</span><span class="pln"> </span><span class="pun">&lt;新名称&gt;</span></code></li></ol></pre><p data-anchor-id="px1g">例:</p><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="1ag2"><ol class="linenums"><li class="L0"><code><span class="pln">git remote rename online oschina</span></code></li></ol></pre><div class="md-section-divider"></div><h2 data-anchor-id="oy4p" id="六-本地仓库代码推送到远程仓库">六 本地仓库代码推送到远程仓库</h2><div class="md-section-divider"></div><h3 data-anchor-id="jmd6" id="61-现在我们根据github的提示在本地的test1仓库下运行命令">6.1 现在，我们根据GitHub的提示，在本地的test1仓库下运行命令：</h3><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="uymb"><ol class="linenums"><li class="L0"><code><span class="pln">git remote add origin https</span><span class="pun">:</span><span class="com">//github.com/gitfenger/test1.git</span></code></li></ol></pre><p data-anchor-id="haoz">请千万注意，把上面的gitfenger替换成你自己的GitHub账户名，否则，你在本地关联的就是我的远程库，关联没有问题，但是你以后推送是推不上去的，因为你的SSH Key公钥不在我的账户列表中。</p><p data-anchor-id="y18j">添加后，远程库的名字就是origin，这是Git默认的叫法，也可以改成别的，但是origin这个名字一看就知道是远程库。</p><p data-anchor-id="tki0">下一步，就可以把本地库的所有内容推送到远程库上：</p><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="j3ef"><ol class="linenums"><li class="L0"><code><span class="pln">$ git push </span><span class="pun">-</span><span class="pln">u origin master</span></code></li><li class="L1"><code><span class="typ">Counting</span><span class="pln"> objects</span><span class="pun">:</span><span class="pln"> </span><span class="lit">19</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">done</span><span class="pun">.</span></code></li><li class="L2"><code><span class="typ">Delta</span><span class="pln"> compression </span><span class="kwd">using</span><span class="pln"> up to </span><span class="lit">4</span><span class="pln"> threads</span><span class="pun">.</span></code></li><li class="L3"><code><span class="typ">Compressing</span><span class="pln"> objects</span><span class="pun">:</span><span class="pln"> </span><span class="lit">100</span><span class="pun">%</span><span class="pln"> </span><span class="pun">(</span><span class="lit">19</span><span class="pun">/</span><span class="lit">19</span><span class="pun">),</span><span class="pln"> </span><span class="kwd">done</span><span class="pun">.</span></code></li><li class="L4"><code><span class="typ">Writing</span><span class="pln"> objects</span><span class="pun">:</span><span class="pln"> </span><span class="lit">100</span><span class="pun">%</span><span class="pln"> </span><span class="pun">(</span><span class="lit">19</span><span class="pun">/</span><span class="lit">19</span><span class="pun">),</span><span class="pln"> </span><span class="lit">13.73</span><span class="pln"> </span><span class="typ">KiB</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">done</span><span class="pun">.</span></code></li><li class="L5"><code><span class="typ">Total</span><span class="pln"> </span><span class="lit">23</span><span class="pln"> </span><span class="pun">(</span><span class="pln">delta </span><span class="lit">6</span><span class="pun">),</span><span class="pln"> reused </span><span class="lit">0</span><span class="pln"> </span><span class="pun">(</span><span class="pln">delta </span><span class="lit">0</span><span class="pun">)</span></code></li><li class="L6"><code><span class="typ">To</span><span class="pln"> git@github</span><span class="pun">.</span><span class="pln">com</span><span class="pun">:</span><span class="pln">gitfenger</span><span class="pun">/</span><span class="pln">test1</span><span class="pun">.</span><span class="pln">git</span></code></li><li class="L7"><code><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="pun">[</span><span class="kwd">new</span><span class="pln"> branch</span><span class="pun">]</span><span class="pln">      master </span><span class="pun">-&gt;</span><span class="pln"> master</span></code></li><li class="L8"><code><span class="typ">Branch</span><span class="pln"> master </span><span class="kwd">set</span><span class="pln"> up to track remote branch master </span><span class="kwd">from</span><span class="pln"> origin</span><span class="pun">.</span></code></li></ol></pre><p data-anchor-id="4imn">把本地库的内容推送到远程，用git push命令，实际上是把当前分支master推送到远程。</p><p data-anchor-id="wpui">由于远程库是空的，我们第一次推送master分支时，加上了-u参数，Git不但会把本地的master分支内容推送的远程新的master分支，还会把本地的master分支和远程的master分支关联起来，在以后的推送或者拉取时就可以简化命令。</p><p data-anchor-id="3am3">推送成功后，可以立刻在GitHub页面中看到远程库的内容已经和本地一模一样：</p><p data-anchor-id="kjl9">从现在起，只要本地作了提交，就可以通过命令：</p><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="1ucx"><ol class="linenums"><li class="L0"><code><span class="pln">$ git push origin master</span></code></li></ol></pre><p data-anchor-id="lj9i">把本地master分支的最新修改推送至GitHub，现在，你就拥有了真正的分布式版本库！</p><div class="md-section-divider"></div><h2 data-anchor-id="xw8a" id="七-团队协作">七 团队协作</h2><div class="md-section-divider"></div><h3 data-anchor-id="d2n4" id="71-生成公私钥">7.1 生成公私钥</h3><div class="md-section-divider"></div><h4 data-anchor-id="ce6y" id="711-设置git的user-name和email">7.1.1 设置Git的user name和email：</h4><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="nfb1"><ol class="linenums"><li class="L0"><code><span class="pln">$ git config </span><span class="pun">--</span><span class="kwd">global</span><span class="pln"> user</span><span class="pun">.</span><span class="pln">name </span><span class="str">"jiaohuafeng"</span></code></li><li class="L1"><code></code></li><li class="L2"><code><span class="pln">$ git config </span><span class="pun">--</span><span class="kwd">global</span><span class="pln"> user</span><span class="pun">.</span><span class="pln">email </span><span class="str">"414582343@qq.com"</span></code></li></ol></pre><div class="md-section-divider"></div><h4 data-anchor-id="lgzm" id="712-生成ssh密钥过程">7.1.2 生成SSH密钥过程：</h4><p data-anchor-id="1ykn">1.查看是否已经有了ssh密钥：cd ~/.ssh</p><p data-anchor-id="7cdz">如果没有密钥则不会有此文件夹，有则备份删除</p><p data-anchor-id="thpx">2.生存密钥：</p><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="pa43"><ol class="linenums"><li class="L0"><code><span class="pln">$ ssh</span><span class="pun">-</span><span class="pln">keygen </span><span class="pun">-</span><span class="pln">t rsa </span><span class="pun">-</span><span class="pln">C </span><span class="str">"414582343@qq.com"</span></code></li></ol></pre><p data-anchor-id="uri1">按3个回车，密码为空。</p><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="tl3s"><ol class="linenums"><li class="L0"><code><span class="typ">Your</span><span class="pln"> identification has been saved </span><span class="kwd">in</span><span class="pln"> </span><span class="pun">/</span><span class="pln">home</span><span class="pun">/</span><span class="pln">tekkub</span><span class="pun">/.</span><span class="pln">ssh</span><span class="pun">/</span><span class="pln">id_rsa</span><span class="pun">.</span></code></li><li class="L1"><code><span class="typ">Your</span><span class="pln"> </span><span class="kwd">public</span><span class="pln"> key has been saved </span><span class="kwd">in</span><span class="pln"> </span><span class="pun">/</span><span class="pln">home</span><span class="pun">/</span><span class="pln">tekkub</span><span class="pun">/.</span><span class="pln">ssh</span><span class="pun">/</span><span class="pln">id_rsa</span><span class="pun">.</span><span class="pln">pub</span><span class="pun">.</span></code></li><li class="L2"><code><span class="typ">The</span><span class="pln"> key fingerprint </span><span class="kwd">is</span><span class="pun">:</span></code></li><li class="L3"><code><span class="pun">………………</span></code></li></ol></pre><p data-anchor-id="vlkl">最后得到了两个文件：id_rsa和id_rsa.pub</p><p data-anchor-id="qe3p">3.添加密钥到ssh：ssh-add 文件名</p><p data-anchor-id="gtl3">需要之前输入密码。</p><p data-anchor-id="6icp">4.在github上添加ssh密钥，这要添加的是“id_rsa.pub”里面的公钥。</p><p data-anchor-id="idox">打开<a href="https://github.com/" target="_blank">https://github.com/</a> ，登陆账号，然后添加ssh。 <br>
<img src="http://on64ewxzt.bkt.clouddn.com/blog/20180328/101645508.png" alt="mark" title=""> <br>
5.测试：ssh git@github.com</p><div class="md-section-divider"></div><h3 data-anchor-id="hlca" id="72-添加项目协作者">7.2 添加项目协作者</h3><p data-anchor-id="opf4"><img src="http://on64ewxzt.bkt.clouddn.com/blog/20180328/101239787.png" alt="mark" title=""></p><div class="md-section-divider"></div><h2 data-anchor-id="9m3j" id="八-版本回退">八 版本回退</h2><p data-anchor-id="nh8d">你不断对文件进行修改，然后不断提交修改到版本库里，就好比玩RPG游戏时，每通过一关就会自动把游戏状态存盘，如果某一关没过去，你还可以选择读取前一关的状态。有些时候，在打Boss之前，你会手动存盘，以便万一打Boss失败了，可以从最近的地方重新开始。Git也是一样，每当你觉得文件修改到一定程度的时候，就可以“保存一个快照”，这个快照在Git中被称为commit。一旦你把文件改乱了，或者误删了文件，还可以从最近的一个commit恢复，然后继续工作，而不是把几个月的工作成果全部丢失。</p><p data-anchor-id="qeca">每个文件/目录发生的版本变化,我们都可以追溯. <br>
命令为:"git log "</p><p data-anchor-id="d3s2">常用格式:</p><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="x5mt"><ol class="linenums"><li class="L0"><code><span class="pln">git log </span><span class="pun">查看项目的日志</span><span class="pln"> </span></code></li><li class="L1"><code><span class="pln">git log </span><span class="str">&lt;file&gt;</span><span class="pln"> </span><span class="pun">查看某文件的日志</span><span class="pln"> </span></code></li><li class="L2"><code><span class="pln">git log </span><span class="pun">.</span><span class="pln"> </span><span class="pun">查看本目录的日志</span></code></li></ol></pre><p data-anchor-id="ajeg">例:</p><p data-anchor-id="efjb">gitlog显示如下 <br>
<img src="http://on64ewxzt.bkt.clouddn.com/blog/20180328/103010684.png" alt="mark" title=""> <br>
如果感觉 log 有点乱,可以 gitlog--pretty=oneline ,让日志单行显示. <br>
<img src="http://on64ewxzt.bkt.clouddn.com/blog/20180328/103035127.png" alt="mark" title=""></p><p data-anchor-id="mj0f">gitreflog 查看版本变化 <br>
<img src="http://on64ewxzt.bkt.clouddn.com/blog/20180328/103132624.png" alt="mark" title=""></p><p data-anchor-id="q2mf">HEAD 指向当前版本 5d5df86 <br>
<img src="http://on64ewxzt.bkt.clouddn.com/blog/20180328/103229581.png" alt="mark" title=""></p><p data-anchor-id="bcqg"><img src="http://on64ewxzt.bkt.clouddn.com/blog/20180328/103315986.png" alt="mark" title=""></p><p data-anchor-id="j3ie">也可以利用版本号来切换,例</p><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="rh0n"><ol class="linenums"><li class="L0"><code><span class="pln">$ git reset </span><span class="pun">--</span><span class="pln">hard </span><span class="lit">6207e59</span><span class="pln"> HEAD </span><span class="kwd">is</span><span class="pln"> now at </span><span class="lit">6207e59</span><span class="pln"> three</span></code></li></ol></pre><p data-anchor-id="o7ka">注意:版本号不用写那么长,能要能保证不与其他版本号重复就行.</p><p data-anchor-id="eddi">例 git reset--hard 6207</p><div class="md-section-divider"></div><h2 data-anchor-id="e54v" id="九-分支管理">九 分支管理</h2><div class="md-section-divider"></div><h3 data-anchor-id="lytb" id="91-分支有什么用">9.1  分支有什么用?</h3><p data-anchor-id="cmj3">在开发中,遇到这样的情况怎么办?</p><p data-anchor-id="50g7">网站已有支付宝在线支付功能,要添加"微信支付".</p><p data-anchor-id="efti">修改了 3 个文件, wechat.php ,pay.php</p><p data-anchor-id="sgip">刚做到一半,突然有个紧急 bug: 支付宝支付后不能修改订单状态.你需要立即马上修改这个 bug,需要修改的文件是,ali.php ,pay.php .</p><p data-anchor-id="b56o">问题是:pay.php ,已经被你修改过,而且尚未完成.直接在此基础上改,肯定有问题.</p><p data-anchor-id="ewal">把 pay.php 倒回去? 那我之前的工作白费了.</p><p data-anchor-id="8mjr">此时你肯定会想: 在做"微信支付"时,能否把仓库复制一份,在此副本上修改,不影响原仓库的内容.修改完毕后,再把副本上的修改合并过去.</p><p data-anchor-id="3rmn">好的,这时你已经有了分支的思想.</p><p data-anchor-id="a2cr">前面见过的 master ,即是代码的主干分支,事实上,在实际的开发中,往往不会直接修改和提交到 master 分支上. </p><p data-anchor-id="lyv2">而是创建一个 dev 分支,在 dev 分支上,修改测试,没问题了,再把 dev 分支合并到 master 上.</p><p data-anchor-id="9ds2">如果有了分支,刚才的难题就好解决了,如下图:</p><p data-anchor-id="r1wi"><img src="http://on64ewxzt.bkt.clouddn.com/blog/20180328/103547537.png" alt="mark" title=""></p><p data-anchor-id="b0le">在做"微信支付"时,我们创建一个 wechat 分支.</p><p data-anchor-id="rr5f">把 wechat 分支 commit ,此时,master 分支内容不会变,因为分支不同.</p><p data-anchor-id="agjj">当遇到紧急 bug 时,创建一个 AliBug 分支.</p><p data-anchor-id="vcj7">修复 bug 后,把 AliBug 分支合并到 master 分支上.</p><p data-anchor-id="o3m3">再次从容切换到 wechat 分支上,接着开发"微信支付"功能,开发完毕后,</p><p data-anchor-id="37me">把 wechat 分支合并到 master 分支上.</p><div class="md-section-divider"></div><h3 data-anchor-id="97qf" id="92-查看分支">9.2 查看分支</h3><p data-anchor-id="pfw5">查看所有分支 gitbranch <br>
例</p><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="2dx4"><ol class="linenums"><li class="L0"><code><span class="pln">git branch</span></code></li><li class="L1"><code></code></li><li class="L2"><code><span class="pun">*</span><span class="pln"> master </span><span class="com"># 说明只有 master 分支,且处于 master 分支.</span></code></li></ol></pre><div class="md-section-divider"></div><h3 data-anchor-id="x68a" id="93-创建分支">9.3 创建分支</h3><p data-anchor-id="6r5y">创建 dev 分支 git branch dev</p><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="q0en"><ol class="linenums"><li class="L0"><code><span class="pln">git branch dev </span><span class="com"># 创建 dev 分支</span></code></li><li class="L1"><code></code></li><li class="L2"><code><span class="pln">git branch </span><span class="com">#查看分支dev</span></code></li><li class="L3"><code></code></li><li class="L4"><code><span class="pun">*</span><span class="pln">master </span><span class="com"># dev 分支创建成功,但仍处于 master 分支</span></code></li></ol></pre><div class="md-section-divider"></div><h3 data-anchor-id="wjg7" id="94-切换分支">9.4 切换分支</h3><p data-anchor-id="qck3">切换到 dev 分支 git checkout dev</p><p data-anchor-id="spkq">再次查看</p><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="0msk"><ol class="linenums"><li class="L0"><code><span class="pln">$ git branch</span></code></li><li class="L1"><code><span class="pun">*</span><span class="pln">dev</span></code></li><li class="L2"><code><span class="pln">master </span><span class="com"># 已切换到 dev 分支上</span></code></li></ol></pre><div class="md-section-divider"></div><h3 data-anchor-id="g1kc" id="95-合并分支">9.5 合并分支</h3><p data-anchor-id="i8yf">当我们在 dev 上开发某功能,并测试通过后,可以把 dev 的内容合并到 master 分支.例: <br>
当前的 readme.txt 内容为"so so",在 dev 分支下,添加一行"from dev"</p><p data-anchor-id="fk52">并提交</p><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="b7gx"><ol class="linenums"><li class="L0"><code><span class="pln">git add readme</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L1"><code><span class="pln">git commit </span><span class="pun">-</span><span class="pln">m </span><span class="str">"mod in dev"</span></code></li></ol></pre><p data-anchor-id="1o3t">再次切换到 master ,查看 readme.txt 的内容,仍为'so so' <br>
合并 dev 分支,gitmergedev , 如下:</p><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="orj9"><ol class="linenums"><li class="L0"><code><span class="pln">$ git merge dev</span></code></li><li class="L1"><code><span class="typ">Updating</span><span class="pln"> c5364fe</span><span class="pun">..</span><span class="lit">412926b</span><span class="pln"> </span><span class="typ">Fast</span><span class="pun">-</span><span class="pln">forward</span></code></li><li class="L2"><code><span class="pln">readme</span><span class="pun">.</span><span class="pln">txt </span><span class="pun">|</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">+</span></code></li><li class="L3"><code><span class="lit">1</span><span class="pln"> file changed</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> insertion</span><span class="pun">(+)</span></code></li></ol></pre><p data-anchor-id="46e9">再次查看 readme.txt 的内容,已变为"soso from dev";</p><div class="md-section-divider"></div><h3 data-anchor-id="a56e" id="96-删除分支">9.6 删除分支</h3><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="kjdq"><ol class="linenums"><li class="L0"><code><span class="pln">git branch </span><span class="pun">-</span><span class="pln">d dev</span></code></li><li class="L1"><code><span class="typ">Deleted</span><span class="pln"> branch dev </span><span class="pun">(</span><span class="pln">was </span><span class="lit">412926b</span><span class="pun">).</span></code></li></ol></pre><div class="md-section-divider"></div><h3 data-anchor-id="upui" id="97-快速创建和切换分支">9.7 快速创建和切换分支</h3><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="ktcw"><ol class="linenums"><li class="L0"><code><span class="pln">git checkout</span><span class="pun">-</span><span class="pln">b dev </span><span class="com"># 创建 dev 分支并立即切换到 dev 分支即起到 git branch dev 和 git checkout dev 的共同作用.</span></code></li></ol></pre></div>
</body>
</html>